(this.webpackJsonplibsjtu=this.webpackJsonplibsjtu||[]).push([[0],{65:function(e,t,n){e.exports=n(95)},70:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(16),l=n.n(c),o=(n(70),n(22)),i=n(8),u=n(120),s=n(122),m=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,null,r.a.createElement("h2",null,"\u5173\u4e8e"),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"data"},"\ud83d\udc68\u200d\ud83d\udcbb")," ","\u6570\u636e\u53d6\u81ea\u5b66\u6821\u5b98\u65b9\u7f51\u7ad9"," ",r.a.createElement("a",{href:"https://canteen.sjtu.edu.cn/",rel:"nofollow"},"canteens")," ","|"," ",r.a.createElement("a",{href:"http://www.lib.sjtu.edu.cn/",rel:"nofollow"},"libraries")),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"smile"},"\ud83d\ude00")," ","\u7a7a\u65f7\u4f18\u5148\uff0c",r.a.createElement("b",null,"\u4f59\u91cf"),"/\u603b\u6570"),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"smile"},"\ud83c\udfa8")," ",r.a.createElement("span",{style:{color:"#4caf50"}},"\u4eba\u5f88\u5c11 "),r.a.createElement("span",{style:{color:"#2196f3"}},"\u4eba\u5c11 "),r.a.createElement("span",{style:{color:"#ff9800"}},"\u4eba\u591a "),r.a.createElement("span",{style:{color:"#f44336"}},"\u4eba\u5f88\u591a "),r.a.createElement("span",{style:{color:"#607d8b"}},"\u65e0\u6548\u6570\u636e ")),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"bot"},"\ud83e\udd16")," ","\u9875\u9762\u6570\u636e\u81ea\u52a8\u5237\u65b0"),r.a.createElement("h2",null,"\u53cd\u9988"),r.a.createElement("a",{href:"https://github.com/SeanChao/libsjtu/issues"},"GitHub Issues"),r.a.createElement("p",null),r.a.createElement(s.a,null),r.a.createElement("p",null),r.a.createElement(o.b,{to:"/"},"\u8fd4\u56de")))},f=n(60),p=n(19),d=n.n(p),b=n(26),E=n(17),g=n(124),h=n(123),v={green:["#4caf50","#e8f5e9"],blue:["#2196f3","#e3f2fd"],yellow:["#ff9800","#fff3e0"],red:["#f44336","#fbe9e7"],default:["#eceff1","#607d8b"]},j=function(e){var t=e.name,n=e.rest,a=e.max,c=n/a*100,l=Object(h.a)((function(){return function(e){var t="",n=v[t=e>=75?"green":e>=50?"blue":e>=25?"yellow":e<25?"red":"default"][0];return{colorPrimary:{backgroundColor:v[t][1]},barColorPrimary:{backgroundColor:n}}}(c)}));return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",marginLeft:"10px",marginRight:"10px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",marginBottom:"10px"}},r.a.createElement("div",{style:{marginRight:"auto"}},t),r.a.createElement("div",{style:{marginLeft:"auto"}},r.a.createElement("b",null,n),"/",a)),r.a.createElement(g.a,{variant:"determinate",value:c,classes:l()}))},y=n(125),w=n(126),x=function(e){var t=e.title,n=Object(a.useMemo)((function(){return e.data&&e.data.length>0?e.data.filter((function(e){return 0!==e.max})).sort((function(e,t){return t.rest/t.max-e.rest/e.max})).concat(e.data.filter((function(e){return 0===e.max}))):[]}),[e.data]);return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"}},t&&""!==t&&r.a.createElement("h2",{style:{marginLeft:"auto",marginRight:"auto"}},t),r.a.createElement(y.a,{container:!0,spacing:4,direction:"column"},e.loading&&r.a.createElement(w.a,{style:{alignSelf:"center",marginTop:"30px",marginBottom:"30px"}}),n.map((function(t,n){return r.a.createElement(y.a,Object.assign({item:!0,key:t.name},e.onClick?{onClick:function(){return e.onClick(n)}}:{}),r.a.createElement(j,{name:t.name,rest:t.rest,max:t.max,key:t.name}),e.subList&&e.subList.includes(n)&&e.renderSubitem(t,n))}))))},O=n(129),k=n(127),S=n(130),C=n(131),L=n(59),A=n.n(L),R=function(e){return"https://canteen.sjtu.edu.cn/CARD/Ajax/PlaceDetails/".concat(e)},T=function(e){return e.map((function(e){return{name:e.Name,rest:e.Seat_s-e.Seat_u,max:e.Seat_s,id:e.Id}}))},D=function(e,t,n){return A.a.get(e).then((function(e){200===e.status?t&&t(e.data):n&&n()})).catch((function(){return n&&n()}))},N=function(){var e=Object(b.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D("https://libsjtu.seanchao.workers.dev/",(function(e){var n=e.match(/CountPerson\((.*)\)/),a=(n.length>1?JSON.parse(n[1]).numbers:[]).map((function(e){return{name:e.areaName,rest:e.max-e.inCounter,max:e.max}}));t&&t(a)}),n));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),W=function(){var e=Object(b.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:D("https://canteen.sjtu.edu.cn/CARD/Ajax/Place",(function(e){var n=T(e);t&&t(n)}),n);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),I=function(){var e=Object(b.a)(d.a.mark((function e(t,n,a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:D(R(t),(function(e){var t=T(e);n&&n(t)}),a);case 1:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),P=(n(94),function(){return r.a.createElement("div",{style:{marginTop:"40px",marginBottom:"40px",display:"flex",justifyContent:"center",flexDirection:"column"}},r.a.createElement("ul",{className:"footer footer-li",style:{listStyleType:"none",display:"flex",justifyContent:"center",marginBottom:"8px",fontSize:"12px",color:"#586069"}},r.a.createElement("li",null,r.a.createElement(o.b,{to:"/about"},"\u5173\u4e8e")),r.a.createElement("li",null,r.a.createElement("a",{href:"https://github.com/SeanChao/libsjtu"},"\u53c2\u4e0e"))))}),B=n(132),F=function(e){var t=Object(a.useState)([]),n=Object(E.a)(t,2),c=n[0],l=n[1],o=Object(a.useState)(!0),i=Object(E.a)(o,2),u=i[0],s=i[1],m=e.data.id;return Object(a.useEffect)((function(){I(m,(function(e){l(e),s(!1)}))}),[m]),Object(a.useEffect)((function(){var e=setInterval((function(){return I(m,(function(e){return l(e)}))}),1e4);return function(){return clearInterval(e)}}),[m]),r.a.createElement("div",{style:{marginLeft:"5vw",marginRight:"5vw",marginTop:"16px"}},r.a.createElement(x,{title:"",data:c,loading:u}))},_=Object(h.a)((function(e){return{campusFilter:{marginTop:e.spacing(1)}}})),J=function(e,t){return e.filter((function(e){return 0===t^e.name.includes("\u5f90\u6c47")}))},U=function(){var e=_(),t=Object(B.a)("campus",0),n=Object(E.a)(t,2),c=n[0],l=n[1],o=Object(a.useState)([]),i=Object(E.a)(o,2),s=i[0],m=i[1],p=Object(a.useState)([]),g=Object(E.a)(p,2),h=g[0],v=g[1],j=Object(a.useState)(!1),w=Object(E.a)(j,2),L=w[0],A=w[1],R=Object(a.useState)(""),T=Object(E.a)(R,2),D=T[0],I=T[1],U=Object(a.useState)(!0),z=Object(E.a)(U,2),H=z[0],M=z[1],G=Object(a.useState)(!0),$=Object(E.a)(G,2),q=$[0],K=$[1],Q=Object(B.a)("canteenSubList",[[],[]]),V=Object(E.a)(Q,2),X=V[0],Y=V[1],Z=function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=function(e){A(!0),I(e)},W((function(e){m(e),K(!1)}),(function(){t("\ud83d\ude25 \u83b7\u53d6\u98df\u5802\u6570\u636e\u5931\u8d25")})),N((function(e){v(e),M(!1)}),(function(){t("\ud83d\ude2b \u83b7\u53d6\u56fe\u4e66\u9986\u6570\u636e\u5931\u8d25")}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){Z()}),[]),Object(a.useEffect)((function(){var e=setInterval((function(){return Z()}),1e4);return function(){return clearInterval(e)}}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,null,r.a.createElement("div",{className:e.campusFilter},r.a.createElement(O.a,{value:c,indicatorColor:"primary",textColor:"primary",onChange:function(e,t){return l(t)},centered:!0},r.a.createElement(k.a,{label:"\u95f5\u884c"}),r.a.createElement(k.a,{label:"\u5f90\u6c47"}))),r.a.createElement(y.a,{container:!0,justify:"center",direction:"column",spacing:2},r.a.createElement(y.a,{item:!0,style:{marginTop:"20px"}},r.a.createElement(x,{title:"\ud83d\udcd6",data:J(h,c),loading:H}),r.a.createElement("div",{style:{marginTop:"16px"}},r.a.createElement("a",{href:"http://booking.lib.sjtu.edu.cn/",target:"_blank",rel:"noopener noreferrer",style:{marginLeft:"10px"}},"\u56fe\u4e66\u9986\u9884\u7ea6"))),r.a.createElement(y.a,{item:!0},r.a.createElement(x,{title:"\ud83c\udf74",data:J(s,c),loading:q,onClick:function(e){return function(e){var t=X[c].includes(e)?X[c].filter((function(t){return t!==e})):X[c].concat(e),n=Object(f.a)(X);n[c]=t,Y(n)}(e)},renderSubitem:function(e,t){return r.a.createElement(F,{id:t,data:e})},subList:X[c]}))),r.a.createElement(S.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:L,autoHideDuration:2e3,onClose:function(){return A(!1),void I("")}},r.a.createElement(C.a,{severity:"error"},D)),r.a.createElement(P,null)))};var z=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(o.a,{basename:"/libsjtu"},r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/about"},r.a.createElement(m,null)),r.a.createElement(i.a,{path:"/"},r.a.createElement(U,null)))))},H=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function M(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!==n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(z,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/libsjtu",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/libsjtu","/service-worker.js");H?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!==a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):M(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):M(t,e)}))}}()}},[[65,1,2]]]);
//# sourceMappingURL=main.f4317fe6.chunk.js.map