{"version":3,"sources":["view/About.js","component/Bar.js","component/ListView.js","lib/fetcher.js","component/Footer.js","component/SubList.js","view/HomeView.js","App.js","serviceWorker.js","index.js"],"names":["AboutView","Container","role","aria-label","href","rel","style","color","Divider","to","colorList","green","blue","yellow","red","default","Bar","props","name","rest","max","percentage","makeStyles","val","scheme","barColor","colorPrimary","backgroundColor","barColorPrimary","mapColor","display","flexDirection","marginLeft","marginRight","width","marginBottom","LinearProgress","variant","value","classes","ListView","title","listData","useMemo","data","length","filter","e","sort","a","b","concat","justifyContent","Grid","container","spacing","direction","loading","CircularProgress","alignSelf","marginTop","map","ele","idx","item","key","onClick","subList","includes","renderSubitem","canteenDetailUrl","id","formatCanteenData","list","Name","Seat_s","Seat_u","Id","axiosGet","url","onSuccess","onFail","axios","get","then","res","status","catch","getLibraryData","process","dataLibMatcher","match","formatted","JSON","parse","numbers","areaName","inCounter","getCanteenData","getDetailedCanteenData","Footer","className","listStyleType","fontSize","SubList","useState","setData","setLoading","useEffect","interval","setInterval","clearInterval","useStyles","theme","campusFilter","filterCampus","dataList","campusId","HomeView","useLocalStorageState","campus","setCampus","dataCanteen","setDataCanteen","dataLib","setDataLib","showSnackbar","setShowSnackbar","snackbarMsg","setSnackbarMsg","libDataLoading","setLibDataLoading","canteenDataLoading","setCanteenDataLoading","canteenSublist","setCanteenSublist","fetchData","openSnackbar","msg","Tabs","indicatorColor","textColor","onChange","_","centered","Tab","label","justify","target","updatedCtSublist","newList","toggleCanteenSublist","Snackbar","anchorOrigin","vertical","horizontal","open","autoHideDuration","onClose","severity","App","basename","path","About","isLocalhost","Boolean","window","location","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","error","ReactDOM","render","StrictMode","document","getElementById","URL","origin","addEventListener","fetch","headers","response","contentType","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.f4317fe6.chunk.js","sourcesContent":["import { Container, Divider } from '@material-ui/core';\nimport React from 'react';\nimport { Link } from 'react-router-dom';\n\nconst AboutView = () => (\n  <>\n    <Container>\n      <h2>关于</h2>\n      <p>\n        <span role=\"img\" aria-label=\"data\">\n          👨‍💻\n        </span>{' '}\n        数据取自学校官方网站{' '}\n        <a href=\"https://canteen.sjtu.edu.cn/\" rel=\"nofollow\">\n          canteens\n        </a>{' '}\n        |{' '}\n        <a href=\"http://www.lib.sjtu.edu.cn/\" rel=\"nofollow\">\n          libraries\n        </a>\n      </p>\n      <p>\n        <span role=\"img\" aria-label=\"smile\">\n          😀\n        </span>{' '}\n        空旷优先，<b>余量</b>/总数\n      </p>\n      <p>\n        <span role=\"img\" aria-label=\"smile\">\n          🎨\n        </span>{' '}\n        <span style={{ color: '#4caf50' }}>人很少 </span>\n        <span style={{ color: '#2196f3' }}>人少 </span>\n        <span style={{ color: '#ff9800' }}>人多 </span>\n        <span style={{ color: '#f44336' }}>人很多 </span>\n        <span style={{ color: '#607d8b' }}>无效数据 </span>\n      </p>\n      <p>\n        <span role=\"img\" aria-label=\"bot\">\n          🤖\n        </span>{' '}\n        页面数据自动刷新\n      </p>\n      <h2>反馈</h2>\n      <a href=\"https://github.com/SeanChao/libsjtu/issues\">GitHub Issues</a>\n      <p></p>\n      <Divider />\n      <p></p>\n      <Link to=\"/\">返回</Link>\n    </Container>\n  </>\n);\n\nexport default AboutView;\n","import React from 'react';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport PropTypes from 'prop-types';\n\nconst colorList = {\n  green: ['#4caf50', '#e8f5e9'],\n  blue: ['#2196f3', '#e3f2fd'],\n  yellow: ['#ff9800', '#fff3e0'],\n  red: ['#f44336', '#fbe9e7'],\n  default: ['#eceff1', '#607d8b'],\n};\n\nconst Bar = (props) => {\n  const name = props.name;\n  const rest = props.rest;\n  const max = props.max;\n  const percentage = (rest / max) * 100;\n\n  const mapColor = (val) => {\n    let scheme = '';\n    if (val >= 75) {\n      scheme = 'green';\n    } else if (val >= 50) {\n      scheme = 'blue';\n    } else if (val >= 25) {\n      scheme = 'yellow';\n    } else if (val < 25) {\n      scheme = 'red';\n    } else {\n      scheme = 'default';\n    }\n    const barColor = colorList[scheme][0];\n    const color = colorList[scheme][1];\n    return {\n      colorPrimary: {\n        backgroundColor: color,\n      },\n      barColorPrimary: {\n        backgroundColor: barColor,\n      },\n    };\n  };\n  const style = makeStyles(() => mapColor(percentage));\n\n  return (\n    <div style={{ display: 'flex', flexDirection: 'column', marginLeft: '10px', marginRight: '10px' }}>\n      <div style={{ display: 'flex', flexDirection: 'row', width: '100%', marginBottom: '10px' }}>\n        <div style={{ marginRight: 'auto' }}>{name}</div>\n        <div style={{ marginLeft: 'auto' }}>\n          <b>{rest}</b>/{max}\n        </div>\n      </div>\n      <LinearProgress variant=\"determinate\" value={percentage} classes={style()} />\n    </div>\n  );\n};\n\nexport default Bar;\n\nBar.propTypes = {\n  name: PropTypes.string.isRequired,\n  rest: PropTypes.number.isRequired,\n  max: PropTypes.number.isRequired,\n};\n","import React, { useMemo } from 'react';\nimport Bar from './Bar';\nimport PropTypes from 'prop-types';\nimport { Grid, CircularProgress } from '@material-ui/core';\n\nconst ListView = (props) => {\n  const title = props.title;\n  const listData = useMemo(\n    () =>\n      props.data && props.data.length > 0\n        ? props.data\n            .filter((e) => e.max !== 0)\n            .sort((a, b) => b.rest / b.max - a.rest / a.max)\n            .concat(props.data.filter((e) => e.max === 0))\n        : [],\n    [props.data]\n  );\n  const renderList = (list) =>\n    list.map((ele, idx) => (\n      <Grid item key={ele.name} {...(props.onClick ? { onClick: () => props.onClick(idx) } : {})}>\n        <Bar name={ele.name} rest={ele.rest} max={ele.max} key={ele.name} />\n        {props.subList && props.subList.includes(idx) && props.renderSubitem(ele, idx)}\n      </Grid>\n    ));\n\n  return (\n    <div style={{ display: 'flex', flexDirection: 'column', justifyContent: 'center' }}>\n      {title && title !== '' && <h2 style={{ marginLeft: 'auto', marginRight: 'auto' }}>{title}</h2>}\n      <Grid container spacing={4} direction=\"column\">\n        {props.loading && <CircularProgress style={{ alignSelf: 'center', marginTop: '30px', marginBottom: '30px' }} />}\n        {renderList(listData)}\n      </Grid>\n    </div>\n  );\n};\n\nexport default ListView;\n\nListView.propTypes = {\n  title: PropTypes.string.isRequired,\n  data: PropTypes.arrayOf(PropTypes.shape({ name: PropTypes.string, rest: PropTypes.number, max: PropTypes.number })).isRequired,\n  loading: PropTypes.bool,\n  onClick: PropTypes.func,\n  subList: PropTypes.arrayOf(PropTypes.number),\n  renderSubitem: PropTypes.func,\n};\n","import axios from 'axios';\n\nconst libraryUrl = process.env.REACT_APP_LIBRARY_PROXY;\nconst canteenUrl = 'https://canteen.sjtu.edu.cn/CARD/Ajax/Place';\nconst canteenDetailUrl = (id) => `https://canteen.sjtu.edu.cn/CARD/Ajax/PlaceDetails/${id}`;\n\nconst formatCanteenData = (list) => list.map((e) => ({ name: e.Name, rest: e.Seat_s - e.Seat_u, max: e.Seat_s, id: e.Id }));\n\nconst axiosGet = (url, onSuccess, onFail) =>\n  axios\n    .get(url)\n    .then((res) => {\n      if (res.status === 200) {\n        onSuccess && onSuccess(res.data);\n      } else {\n        onFail && onFail();\n      }\n    })\n    .catch(() => onFail && onFail());\n\nexport const getLibraryData = async (onSuccess, onFail) =>\n  axiosGet(\n    libraryUrl,\n    (data) => {\n      const dataLibRaw = data;\n      const dataLibMatcher = dataLibRaw.match(/CountPerson\\((.*)\\)/);\n      const dataLib = dataLibMatcher.length > 1 ? JSON.parse(dataLibMatcher[1]).numbers : [];\n      const formatted = dataLib.map((e) => ({ name: e.areaName, rest: e.max - e.inCounter, max: e.max }));\n      onSuccess && onSuccess(formatted);\n    },\n    onFail\n  );\n\nexport const getCanteenData = async (onSuccess, onFail) => {\n  axiosGet(\n    canteenUrl,\n    (data) => {\n      const formatted = formatCanteenData(data);\n      onSuccess && onSuccess(formatted);\n    },\n    onFail\n  );\n};\n\nexport const getDetailedCanteenData = async (id, onSuccess, onFail) => {\n  axiosGet(\n    canteenDetailUrl(id),\n    (data) => {\n      const formatted = formatCanteenData(data);\n      onSuccess && onSuccess(formatted);\n    },\n    onFail\n  );\n};\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport './Footer.css';\n\nconst Footer = () => (\n  <div\n    style={{\n      marginTop: '40px',\n      marginBottom: '40px',\n      display: 'flex',\n      justifyContent: 'center',\n      flexDirection: 'column',\n    }}\n  >\n    <ul className=\"footer footer-li\" style={{ listStyleType: 'none', display: 'flex', justifyContent: 'center', marginBottom: '8px', fontSize: '12px', color: '#586069' }}>\n      <li>\n        <Link to=\"/about\">关于</Link>\n      </li>\n      <li>\n        <a href=\"https://github.com/SeanChao/libsjtu\">参与</a>\n      </li>\n    </ul>\n  </div>\n);\n\nexport default Footer;\n","import React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { getDetailedCanteenData } from '../lib/fetcher';\nimport ListView from './ListView';\n\nconst SubList = (props) => {\n  const [data, setData] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  const id = props.data.id;\n\n  useEffect(() => {\n    getDetailedCanteenData(id, (data) => {\n      setData(data);\n      setLoading(false);\n    });\n  }, [id]);\n\n  useEffect(() => {\n    const interval = setInterval(() => getDetailedCanteenData(id, (data) => setData(data)), 10000);\n    return () => clearInterval(interval);\n  }, [id]);\n\n  return (\n    <div style={{ marginLeft: '5vw', marginRight: '5vw', marginTop: '16px' }}>\n      <ListView title=\"\" data={data} loading={loading} />\n    </div>\n  );\n};\n\nSubList.propTypes = {\n  data: PropTypes.object.isRequired,\n};\n\nexport default SubList;\n","import React, { useEffect, useState } from 'react';\nimport ListView from '../component/ListView';\nimport { Container, Grid, Snackbar, Tab, Tabs } from '@material-ui/core';\nimport MuiAlert from '@material-ui/lab/Alert';\nimport { getCanteenData, getLibraryData } from '../lib/fetcher';\nimport Footer from '../component/Footer';\nimport { useLocalStorageState } from 'ahooks';\nimport { makeStyles } from '@material-ui/core/styles';\nimport SubList from '../component/SubList';\n\nconst useStyles = makeStyles((theme) => ({\n  campusFilter: {\n    marginTop: theme.spacing(1),\n  },\n}));\n\nconst filterCampus = (dataList, campusId) => dataList.filter((item) => (campusId === 0) ^ item.name.includes('徐汇'));\n\nconst HomeView = () => {\n  const classes = useStyles();\n  const [campus, setCampus] = useLocalStorageState('campus', 0);\n\n  const [dataCanteen, setDataCanteen] = useState([]);\n  const [dataLib, setDataLib] = useState([]);\n  const [showSnackbar, setShowSnackbar] = useState(false);\n  const [snackbarMsg, setSnackbarMsg] = useState('');\n\n  const [libDataLoading, setLibDataLoading] = useState(true);\n  const [canteenDataLoading, setCanteenDataLoading] = useState(true);\n\n  const [canteenSublist, setCanteenSublist] = useLocalStorageState('canteenSubList', [[], []]);\n\n  const fetchData = async () => {\n    const openSnackbar = (msg) => {\n      setShowSnackbar(true);\n      setSnackbarMsg(msg);\n    };\n    getCanteenData(\n      (data) => {\n        setDataCanteen(data);\n        setCanteenDataLoading(false);\n      },\n      () => {\n        openSnackbar('😥 获取食堂数据失败');\n      }\n    );\n    getLibraryData(\n      (data) => {\n        setDataLib(data);\n        setLibDataLoading(false);\n      },\n      () => {\n        openSnackbar('😫 获取图书馆数据失败');\n      }\n    );\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    const interval = setInterval(() => fetchData(), 10000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const closeSnackbar = () => {\n    setShowSnackbar(false);\n    setSnackbarMsg('');\n  };\n\n  const toggleCanteenSublist = (idx) => {\n    const updatedCtSublist = canteenSublist[campus].includes(idx) ? canteenSublist[campus].filter((e) => e !== idx) : canteenSublist[campus].concat(idx);\n    const newList = [...canteenSublist];\n    newList[campus] = updatedCtSublist;\n    setCanteenSublist(newList);\n  };\n\n  return (\n    <>\n      <Container>\n        <div className={classes.campusFilter}>\n          <Tabs value={campus} indicatorColor=\"primary\" textColor=\"primary\" onChange={(_, value) => setCampus(value)} centered>\n            <Tab label=\"闵行\" />\n            <Tab label=\"徐汇\" />\n          </Tabs>\n        </div>\n        <Grid container justify=\"center\" direction=\"column\" spacing={2}>\n          <Grid item style={{ marginTop: '20px' }}>\n            <ListView title=\"📖\" data={filterCampus(dataLib, campus)} loading={libDataLoading} />\n            <div style={{ marginTop: '16px' }}>\n              <a href=\"http://booking.lib.sjtu.edu.cn/\" target=\"_blank\" rel=\"noopener noreferrer\" style={{ marginLeft: '10px' }}>\n                图书馆预约\n              </a>\n            </div>\n          </Grid>\n          <Grid item>\n            <ListView\n              title=\"🍴\"\n              data={filterCampus(dataCanteen, campus)}\n              loading={canteenDataLoading}\n              onClick={(idx) => toggleCanteenSublist(idx)}\n              renderSubitem={(ele, idx) => <SubList id={idx} data={ele} />}\n              subList={canteenSublist[campus]}\n            />\n          </Grid>\n        </Grid>\n        <Snackbar\n          anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'left',\n          }}\n          open={showSnackbar}\n          autoHideDuration={2000}\n          onClose={() => closeSnackbar()}\n        >\n          <MuiAlert severity=\"error\">{snackbarMsg}</MuiAlert>\n        </Snackbar>\n        <Footer />\n      </Container>\n    </>\n  );\n};\n\nexport default HomeView;\n","import React from 'react';\nimport { Route, BrowserRouter as Router, Switch } from 'react-router-dom';\nimport AboutView from './view/About';\nimport HomeView from './view/HomeView';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Router basename={process.env.PUBLIC_URL}>\n        <Switch>\n          <Route path=\"/about\">\n            <AboutView />\n          </Route>\n          <Route path=\"/\">\n            <HomeView />\n          </Route>\n        </Switch>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n","/* eslint-disable no-console */\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log('This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA');\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker === null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log('New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA.');\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (response.status === 404 || (contentType !== null && contentType.indexOf('javascript') === -1)) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}