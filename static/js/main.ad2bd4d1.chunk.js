(this.webpackJsonplibsjtu=this.webpackJsonplibsjtu||[]).push([[0],{65:function(e,t,n){e.exports=n(95)},70:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(16),c=n.n(l),o=(n(70),n(22)),i=n(8),u=n(120),s=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,null,r.a.createElement("h2",null,"\u5173\u4e8e"),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"data"},"\ud83d\udc68\u200d\ud83d\udcbb")," ","\u6570\u636e\u53d6\u81ea\u5b66\u6821\u5b98\u65b9\u7f51\u7ad9"," ",r.a.createElement("a",{href:"https://canteen.sjtu.edu.cn/",rel:"nofollow"},"canteens")," ","|"," ",r.a.createElement("a",{href:"http://www.lib.sjtu.edu.cn/",rel:"nofollow"},"libraries")),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"smile"},"\ud83d\ude00")," ","\u7a7a\u65f7\u4f18\u5148\uff0c",r.a.createElement("b",null,"\u4f59\u91cf"),"/\u603b\u6570"),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"smile"},"\ud83c\udfa8")," ",r.a.createElement("span",{style:{color:"#4caf50"}},"\u4eba\u5f88\u5c11 "),r.a.createElement("span",{style:{color:"#2196f3"}},"\u4eba\u5c11 "),r.a.createElement("span",{style:{color:"#ff9800"}},"\u4eba\u591a "),r.a.createElement("span",{style:{color:"#f44336"}},"\u4eba\u5f88\u591a "),r.a.createElement("span",{style:{color:"#607d8b"}},"\u65e0\u6548\u6570\u636e ")),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"bot"},"\ud83e\udd16")," ","\u9875\u9762\u6570\u636e\u81ea\u52a8\u5237\u65b0"),r.a.createElement("h2",null,"\u53cd\u9988"),r.a.createElement("a",{href:"https://github.com/SeanChao/libsjtu/issues"},"GitHub Issues"),r.a.createElement("p",null),r.a.createElement(o.b,{to:"/"},"\u8fd4\u56de")))},m=n(20),f=n.n(m),p=n(33),d=n(21),b=n(60),E=n(123),h=n(122),g={green:["#4caf50","#e8f5e9"],blue:["#2196f3","#e3f2fd"],yellow:["#ff9800","#fff3e0"],red:["#f44336","#fbe9e7"],default:["#eceff1","#607d8b"]},v=function(e){var t=e.name,n=e.rest,a=e.max,l=n/a*100,c=Object(h.a)((function(){return function(e){var t="",n=g[t=e>=75?"green":e>=50?"blue":e>=25?"yellow":e<25?"red":"default"][0];return{colorPrimary:{backgroundColor:g[t][1]},barColorPrimary:{backgroundColor:n}}}(l)}));return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",marginLeft:"10px",marginRight:"10px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",marginBottom:"10px"}},r.a.createElement("div",{style:{marginRight:"auto"}},t),r.a.createElement("div",{style:{marginLeft:"auto"}},r.a.createElement("b",null,n),"/",a)),r.a.createElement(E.a,{variant:"determinate",value:l,classes:c()}))},y=n(124),j=n(125),w=function(e){var t=e.title,n=Object(a.useMemo)((function(){return e.data&&e.data.length>0?Object(b.a)(e.data).sort((function(e,t){return 0===e.max?1:0===t.max?-1:t.rest/t.max-e.rest/e.max})):[]}),[e.data]);return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"}},r.a.createElement("h2",{style:{marginLeft:"auto",marginRight:"auto"}},t),r.a.createElement(y.a,{container:!0,spacing:4,direction:"column"},e.loading&&r.a.createElement(j.a,{style:{alignSelf:"center",marginTop:"30px",marginBottom:"30px"}}),n.map((function(e){return r.a.createElement(y.a,{item:!0,key:e.name},r.a.createElement(v,{name:e.name,rest:e.rest,max:e.max,key:e.name}))}))))},x=n(128),O=n(126),S=n(129),k=n(130),C=n(43),A=n.n(C),N=function(){var e=Object(p.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A.a.get("https://libsjtu.seanchao.workers.dev/").then((function(e){if(200===e.status){var a=e.data.match(/CountPerson\((.*)\)/),r=(a.length>1?JSON.parse(a[1]).numbers:[]).map((function(e){return{name:e.areaName,rest:e.max-e.inCounter,max:e.max}}));t&&t(r)}else n&&n()})).catch((function(){return n&&n()}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),W=function(){var e=Object(p.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A.a.get("https://canteen.sjtu.edu.cn/CARD/Ajax/Place").then((function(e){if(200===e.status){var a=e.data.map((function(e){return{name:e.Name,rest:e.Seat_s-e.Seat_u,max:e.Seat_s}}));t&&t(a)}else n&&n()})).catch((function(){return n&&n()}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),R=(n(94),function(){return r.a.createElement("div",{style:{marginTop:"40px",marginBottom:"40px",display:"flex",justifyContent:"center",flexDirection:"column"}},r.a.createElement("ul",{className:"footer footer-li",style:{listStyleType:"none",display:"flex",justifyContent:"center",marginBottom:"8px",fontSize:"12px",color:"#586069"}},r.a.createElement("li",null,r.a.createElement(o.b,{to:"/about"},"\u5173\u4e8e")),r.a.createElement("li",null,r.a.createElement("a",{href:"https://github.com/SeanChao/libsjtu"},"\u53c2\u4e0e"))))}),T=n(131),B=Object(h.a)((function(e){return{campusFilter:{marginTop:e.spacing(1)}}})),D=function(e,t){return e.filter((function(e){return 0===t^e.name.includes("\u5f90\u6c47")}))},P=function(){var e=B(),t=Object(T.a)("campus",0),n=Object(d.a)(t,2),l=n[0],c=n[1],o=Object(a.useState)([]),i=Object(d.a)(o,2),s=i[0],m=i[1],b=Object(a.useState)([]),E=Object(d.a)(b,2),h=E[0],g=E[1],v=Object(a.useState)(!1),j=Object(d.a)(v,2),C=j[0],A=j[1],P=Object(a.useState)(""),L=Object(d.a)(P,2),F=L[0],I=L[1],J=Object(a.useState)(!0),U=Object(d.a)(J,2),_=U[0],z=U[1],H=Object(a.useState)(!0),M=Object(d.a)(H,2),G=M[0],$=M[1],q=function(){var e=Object(p.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=function(e){A(!0),I(e)},W((function(e){m(e),$(!1)}),(function(){t("\ud83d\ude25 \u83b7\u53d6\u98df\u5802\u6570\u636e\u5931\u8d25")})),N((function(e){g(e),z(!1)}),(function(){t("\ud83d\ude2b \u83b7\u53d6\u56fe\u4e66\u9986\u6570\u636e\u5931\u8d25")}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){q()}),[F]),Object(a.useEffect)((function(){var e=setInterval((function(){return q()}),1e4);return function(){return clearInterval(e)}}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,null,r.a.createElement("div",{className:e.campusFilter},r.a.createElement(x.a,{value:l,indicatorColor:"primary",textColor:"primary",onChange:function(e,t){return c(t)},centered:!0},r.a.createElement(O.a,{label:"\u95f5\u884c"}),r.a.createElement(O.a,{label:"\u5f90\u6c47"}))),r.a.createElement(y.a,{container:!0,justify:"center",direction:"column",spacing:2},r.a.createElement(y.a,{item:!0,style:{marginTop:"20px"}},r.a.createElement(w,{title:"\ud83d\udcd6",data:D(h,l),loading:_})),r.a.createElement(y.a,{item:!0},r.a.createElement(w,{title:"\ud83c\udf74",data:D(s,l),loading:G}))),r.a.createElement(S.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:C,autoHideDuration:2e3,onClose:function(){return A(!1),void I("")}},r.a.createElement(k.a,{severity:"error"},F)),r.a.createElement(R,null)))};var L=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(o.a,{basename:"/libsjtu"},r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/about"},r.a.createElement(s,null)),r.a.createElement(i.a,{path:"/"},r.a.createElement(P,null)))))},F=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function I(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!==n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(L,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/libsjtu",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/libsjtu","/service-worker.js");F?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!==a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):I(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):I(t,e)}))}}()}},[[65,1,2]]]);
//# sourceMappingURL=main.ad2bd4d1.chunk.js.map