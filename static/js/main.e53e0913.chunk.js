(this.webpackJsonplibsjtu=this.webpackJsonplibsjtu||[]).push([[0],{62:function(e,t,n){e.exports=n(92)},67:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(15),o=n.n(l),c=(n(67),n(22)),i=n(6),u=n(114),s=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,null,r.a.createElement("h2",null,"\u5173\u4e8e"),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"data"},"\ud83d\udc68\u200d\ud83d\udcbb")," ","\u6570\u636e\u53d6\u81ea\u5b66\u6821\u5b98\u65b9\u7f51\u7ad9"," ",r.a.createElement("a",{href:"https://canteen.sjtu.edu.cn/",rel:"nofollow"},"canteens")," ","|"," ",r.a.createElement("a",{href:"http://www.lib.sjtu.edu.cn/",rel:"nofollow"},"libraries")),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"smile"},"\ud83d\ude00")," ","\u7a7a\u65f7\u4f18\u5148\uff0c",r.a.createElement("b",null,"\u4f59\u91cf"),"/\u603b\u6570"),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"smile"},"\ud83c\udfa8")," ",r.a.createElement("span",{style:{color:"#4caf50"}},"\u4eba\u5f88\u5c11 "),r.a.createElement("span",{style:{color:"#2196f3"}},"\u4eba\u5c11 "),r.a.createElement("span",{style:{color:"#ff9800"}},"\u4eba\u591a "),r.a.createElement("span",{style:{color:"#f44336"}},"\u4eba\u5f88\u591a "),r.a.createElement("span",{style:{color:"#607d8b"}},"\u65e0\u6548\u6570\u636e ")),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"bot"},"\ud83e\udd16")," ","\u9875\u9762\u6570\u636e\u81ea\u52a8\u5237\u65b0"),r.a.createElement("h2",null,"\u53cd\u9988"),r.a.createElement("a",{href:"https://github.com/SeanChao/libsjtu/issues"},"GitHub Issues"),r.a.createElement("p",null),r.a.createElement(c.b,{to:"/"},"\u8fd4\u56de")))},m=n(20),f=n.n(m),p=n(31),d=n(21),h=n(56),b=n(117),E=n(116),g={green:["#4caf50","#e8f5e9"],blue:["#2196f3","#e3f2fd"],yellow:["#ff9800","#fff3e0"],red:["#f44336","#fbe9e7"],default:["#eceff1","#607d8b"]},v=function(e){var t=e.name,n=e.rest,a=e.max,l=n/a*100,o=Object(E.a)((function(){return function(e){var t="",n=g[t=e>=75?"green":e>=50?"blue":e>=25?"yellow":e<25?"red":"default"][0];return{colorPrimary:{backgroundColor:g[t][1]},barColorPrimary:{backgroundColor:n}}}(l)}));return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",marginLeft:"10px",marginRight:"10px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",marginBottom:"10px"}},r.a.createElement("div",{style:{marginRight:"auto"}},t),r.a.createElement("div",{style:{marginLeft:"auto"}},r.a.createElement("b",null,n),"/",a)),r.a.createElement(b.a,{variant:"determinate",value:l,classes:o()}))},y=n(118),w=n(119),j=function(e){var t=e.title,n=Object(a.useMemo)((function(){return e.data&&e.data.length>0?Object(h.a)(e.data).sort((function(e,t){return 0===e.max?1:0===t.max?-1:t.rest/t.max-e.rest/e.max})):[]}),[e.data]);return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"}},r.a.createElement("h2",{style:{marginLeft:"auto",marginRight:"auto"}},t),r.a.createElement(y.a,{container:!0,spacing:4,direction:"column"},e.loading&&r.a.createElement(w.a,{style:{alignSelf:"center",marginTop:"30px",marginBottom:"30px"}}),n.map((function(e){return r.a.createElement(y.a,{item:!0,key:e.name},r.a.createElement(v,{name:e.name,rest:e.rest,max:e.max,key:e.name}))}))))},x=n(122),O=n(121),S=n(40),k=n.n(S),C=function(){var e=Object(p.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.a.get("https://libsjtu.seanchao.workers.dev/").then((function(e){if(200===e.status){var a=e.data.match(/CountPerson\((.*)\)/),r=(a.length>1?JSON.parse(a[1]).numbers:[]).map((function(e){return{name:e.areaName,rest:e.max-e.inCounter,max:e.max}}));t&&t(r)}else n&&n()})).catch((function(){return n&&n()}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),A=function(){var e=Object(p.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.a.get("https://canteen.sjtu.edu.cn/CARD/Ajax/Place").then((function(e){if(200===e.status){var a=e.data.map((function(e){return{name:e.Name,rest:e.Seat_s-e.Seat_u,max:e.Seat_s}}));t&&t(a)}else n&&n()})).catch((function(){return n&&n()}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),W=(n(91),function(){return r.a.createElement("div",{style:{marginTop:"40px",marginBottom:"40px",display:"flex",justifyContent:"center",flexDirection:"column"}},r.a.createElement("ul",{className:"footer footer-li",style:{listStyleType:"none",display:"flex",justifyContent:"center",marginBottom:"8px",fontSize:"12px",color:"#586069"}},r.a.createElement("li",null,r.a.createElement(c.b,{to:"/about"},"\u5173\u4e8e")),r.a.createElement("li",null,r.a.createElement("a",{href:"https://github.com/SeanChao/libsjtu"},"\u53c2\u4e0e"))))}),N=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],l=t[1],o=Object(a.useState)([]),c=Object(d.a)(o,2),i=c[0],s=c[1],m=Object(a.useState)(!1),h=Object(d.a)(m,2),b=h[0],E=h[1],g=Object(a.useState)(""),v=Object(d.a)(g,2),w=v[0],S=v[1],k=Object(a.useState)(!0),N=Object(d.a)(k,2),R=N[0],B=N[1],D=Object(a.useState)(!0),P=Object(d.a)(D,2),T=P[0],L=P[1],I=function(){var e=Object(p.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=function(e){E(!0),S(e)},A((function(e){l(e),L(!1)}),(function(){t("\ud83d\ude25 \u83b7\u53d6\u98df\u5802\u6570\u636e\u5931\u8d25")})),C((function(e){s(e),B(!1)}),(function(){t("\ud83d\ude2b \u83b7\u53d6\u56fe\u4e66\u9986\u6570\u636e\u5931\u8d25")}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){I()}),[w]),Object(a.useEffect)((function(){var e=setInterval((function(){return I()}),1e4);return function(){return clearInterval(e)}}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,null,r.a.createElement(y.a,{container:!0,justify:"center",direction:"column",spacing:2},r.a.createElement(y.a,{item:!0,style:{marginTop:"20px"}},r.a.createElement(j,{title:"\ud83d\udcd6",data:i,loading:R})),r.a.createElement(y.a,{item:!0},r.a.createElement(j,{title:"\ud83c\udf74",data:n,loading:T}))),r.a.createElement(x.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:b,autoHideDuration:2e3,onClose:function(){return E(!1),void S("")}},r.a.createElement(O.a,{severity:"error"},w)),r.a.createElement(W,null)))};var R=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(c.a,{basename:"/libsjtu"},r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/about"},r.a.createElement(s,null)),r.a.createElement(i.a,{path:"/"},r.a.createElement(N,null)))))},B=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function D(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!==n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(R,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/libsjtu",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/libsjtu","/service-worker.js");B?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!==a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):D(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):D(t,e)}))}}()}},[[62,1,2]]]);
//# sourceMappingURL=main.e53e0913.chunk.js.map